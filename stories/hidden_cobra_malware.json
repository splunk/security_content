{
  "category": "Malware",
  "channel": "ESCU",
  "creation_date": "2018-06-14",
  "description": "Monitor for and investigate activities, including the creation or deletion of hidden shares and file writes, that may be evidence of infiltration by North Korean government-sponsored cybercriminals. Details of this activity were reported in DHS Report TA-18-149A.",
  "id": "baf7580b-d4b4-4774-8173-7d198e9da335",
  "maintainers": [
    {
      "company": "Splunk",
      "email": "rvaldez@splunk.com",
      "name": "Rico Valdez"
    }
  ],
  "modification_date": "2018-06-14",
  "name": "Hidden Cobra Malware",
  "narrative": "North Korea's government-sponsored \"cyber army\" has been slowly building momentum and gaining sophistication over the last 15 years or so. As a result, the group's activity, which the US government refers to as \"Hidden Cobra,\" has surreptitiously crept onto the collective radar as a preeminent global threat.<br></br>These state-sponsored actors are thought to be responsible for everything from a hack on a South Korean nuclear plant to an attack on Sony in anticipation of its release of the movie \"The Interview\" at the end of 2014. They're also notorious for cyberespionage. In recent years, the group seems to be focused on financial crimes, such as cryptojacking.<br></br>In June of 2018, The Department of Homeland Security, together with the FBI and other U.S. government partners, issued Technical Alert (TA-18-149A) to advise the public about two variants of North Korean malware. One variant, dubbed \"Joanap,\" is a multi-stage peer-to-peer botnet that allows North Korean state actors to exfiltrate data, download and execute secondary payloads, and initialize proxy communications. The other variant, \"Brambul,\" is a Windows32 SMB worm that is dropped into a victim network. When executed, the malware attempts to spread laterally within a victim's local subnet, connecting via the SMB protocol and initiating brute-force password attacks. It reports details to the Hidden Cobra actors via email, so they can use the information for secondary remote operations.<br></br>Among other searches in this Analytic Story is a detection search that looks for the creation or deletion of hidden shares, such as, \"adnim$,\" which the Hidden Cobra malware creates on the target system. Another looks for the creation of three malicious files associated with the malware. You can also use a search in this story to investigate activity that indicates that malware is sending email back to the attackers.",
  "original_authors": [
    {
      "company": "Splunk",
      "email": "rvaldez@splunk.com",
      "name": "Rico Valdez"
    }
  ],
  "references": [
    "https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity",
    "https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Destructive-Malware-Report.pdf"
  ],
  "searches": {
    "contextual_searches": [
      "Get Notable Info",
      "Get Notable History",
      "Get User Information from Identity Table",
      "Get Authentication Logs For Endpoint",
      "Get Risk Modifiers For User",
      "Get Risk Modifiers For Endpoint"
    ],
    "detection_searches": [
      "SMB Traffic Spike",
      "SMB Traffic Spike - MLTK",
      "First time seen command line argument",
      "Detect Outbound SMB Traffic",
      "Remote Desktop Network Traffic",
      "Remote Desktop Process Running On System",
      "DNS Query Length With High Standard Deviation",
      "Create or delete hidden shares using net.exe",
      "Suspicious File Write",
      "DNS Query Length Outliers - MLTK"
    ],
    "investigative_searches": [
      "Get Process Info",
      "Get Process Information For Port Activity",
      "Get Parent Process Info",
      "Get Outbound Emails to Hidden Cobra Threat Actors"
    ],
    "support_searches": [
      "Previously seen command line arguments",
      "Model Builder For DNS Query Length Outliers - MLTK",
      "Model Builder For SMB Traffic Spike MLTK"
    ]
  },
  "spec_version": 1,
  "version": "2.0"
}
