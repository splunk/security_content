name: Zscaler Exploit Threat Blocked
id: 94665d8c-b841-4ff4-acb4-34d613e2cbfe
version: 2
date: '2024-05-13'
author: Rod Soto, Gowthamaraj Rajendran, Splunk
status: production
type: TTP
data_source: []
description: The following analytic identifies potential exploit attempts involving
  command and script interpreters blocked by Zscaler. It leverages web proxy logs
  to detect incidents where actions are blocked due to exploit references. The detection
  compiles statistics by user, threat name, URL, hostname, file class, and filename.
  This activity is significant as it helps identify and mitigate exploit attempts,
  which are critical for maintaining security. If confirmed malicious, such activity
  could lead to unauthorized code execution, privilege escalation, or persistent access
  within the environment, posing a severe threat to organizational security.
search: '`zscaler_proxy` action=blocked threatname=*exploit* | stats count min(_time)
  as firstTime max(_time) as lastTime  by user threatname src hostname fileclass filename
  url dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`
  | `zscaler_exploit_threat_blocked_filter`'
how_to_implement: You must install the latest version of Zscaler Add-on from Splunkbase.
  You must be ingesting Zscaler events into your Splunk environment through an ingester.
  This analytic was written to be used with the "zscalernss-web" sourcetype leveraging
  the Zscaler proxy data. This enables the integration with Splunk Enterprise Security.
  Security teams are encouraged to adjust the detection parameters, ensuring the detection
  is tailored to their specific environment.
known_false_positives: False positives are limited to Zscaler configuration.
references:
- https://help.zscaler.com/zia/nss-feed-output-format-web-logs
tags:
  analytic_story:
  - Zscaler Browser Proxy Threats
  asset_type: Web Server
  confidence: 80
  impact: 50
  message: Potential Exploit Threat from dest -[$dest$] on $src$ for user-[$user$].
  mitre_attack_id:
  - T1566
  observable:
  - name: src
    type: IP Address
    role:
    - Victim
  - name: user
    type: User
    role:
    - Victim
  - name: url
    type: URL String
    role:
    - Attacker
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  risk_score: 40
  required_fields:
  - action
  - threatname
  - deviceowner
  - user
  - urlcategory
  - url
  - dest
  - dest_ip
  - action
  security_domain: threat
tests:
- name: True Positive Test
  attack_data:
  - data: 
      https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1566/zscalar_web_proxy/zscalar_web_proxy.json
    source: zscaler
    sourcetype: zscalernss-web
