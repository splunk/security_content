name: Ivanti EPMM Remote Unauthenticated API Access CVE-2023-35078
id: 66b9c9ba-7fb2-4e80-a3a2-496e5e078167
version: 2
date: '2024-05-18'
author: Michael Haag, Splunk
status: production
type: TTP
data_source:
- Suricata
description: The following analytic detects attempts to exploit CVE-2023-35078, a
  vulnerability in Ivanti Endpoint Manager Mobile (EPMM) versions up to 11.4. It identifies
  HTTP requests to the endpoint "/mifs/aad/api/v2/authorized/users?*" with a status
  code of 200 in web logs. This activity is significant as it indicates unauthorized
  remote access to restricted functionalities or resources. If confirmed malicious,
  this could lead to data theft, unauthorized modifications, or further system compromise,
  necessitating immediate action to mitigate potential severe impacts.
search: '| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web
  where Web.url IN ("/mifs/aad/api/v2/authorized/users?*") Web.status=200 by Web.http_user_agent,
  Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype
  | `drop_dm_object_name("Web")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`
  | `ivanti_epmm_remote_unauthenticated_api_access_cve_2023_35078_filter`'
how_to_implement: To implement this analytic, a network product similar to Suricata
  or Palo Alto needs to be mapped to the Web datamodel. Modify accordingly to work
  with your products.
known_false_positives: The Proof of Concept exploit script indicates that status=200
  is required for successful exploitation of the vulnerability. False positives may
  be present if status=200 is removed from the search.  If it is removed,then the
  search also alert on status=301 and status=404 which indicates unsuccessful exploitation
  attempts.  Analysts may find it useful to hunt for these status codes as well, but
  it is likely to produce a significant number of alerts as this is a widespread vulnerability.
references:
- https://forums.ivanti.com/s/article/CVE-2023-35078-Remote-unauthenticated-API-access-vulnerability?language=en_US
- https://github.com/vchan-in/CVE-2023-35078-Exploit-POC/blob/main/cve_2023_35078_poc.py
tags:
  analytic_story:
  - Ivanti EPMM Remote Unauthenticated Access
  asset_type: Web Server
  cve:
  - CVE-2023-35078
  atomic_guid: []
  confidence: 80
  impact: 80
  message: Potential CVE-2023-35078 against an Ivanti EPMM appliance on $dest$.
  mitre_attack_id:
  - T1190
  - T1133
  observable:
  - name: dest
    type: Hostname
    role:
    - Victim
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  risk_score: 64
  required_fields:
  - _time
  - Web.http_method
  - Web.url
  - Web.url_length
  - Web.src
  - Web.dest
  security_domain: network
tests:
- name: True Positive Test
  attack_data:
  - data: 
      https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/ivanti/suricata_ivanti_CVE202335078.log
    source: suricata
    sourcetype: suricata

