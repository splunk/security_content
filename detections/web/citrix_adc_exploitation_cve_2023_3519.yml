name: Citrix ADC Exploitation CVE-2023-3519
id: 76ac2dcb-333c-4a77-8ae9-2720cfae47a8
version: 3
date: '2024-05-25'
author: Michael Haag, Splunk
status: production
type: Hunting
data_source:
- Palo Alto Network Threat
description: The following analytic identifies potential exploitation attempts against
  Citrix ADC related to CVE-2023-3519. It detects POST requests to specific web endpoints
  associated with this vulnerability by leveraging the Web datamodel. This activity
  is significant as CVE-2023-3519 involves a SAML processing overflow issue that can
  lead to memory corruption, posing a high risk. If confirmed malicious, attackers
  could exploit this to execute arbitrary code, escalate privileges, or disrupt services,
  making it crucial for SOC analysts to monitor and investigate these alerts promptly.
search: '| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web
  where Web.url IN ("*/saml/login","/cgi/samlauth","*/saml/activelogin","/cgi/samlart?samlart=*","*/cgi/logout","/gwtest/formssso?event=start&target=*","/netscaler/ns_gui/vpn/*")  Web.http_method=POST
  by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src,
  Web.dest, sourcetype | `drop_dm_object_name("Web")` | `security_content_ctime(firstTime)`
  | `security_content_ctime(lastTime)` | `citrix_adc_exploitation_cve_2023_3519_filter`'
how_to_implement: This detection requires the Web datamodel to be populated from a
  supported Technology Add-On like Splunk for Apache, Splunk for Nginx, or Splunk
  for Palo Alto.
known_false_positives: False positives may be present based on organization use of
  SAML utilities. Filter, or restrict the analytic to Citrix devices only.
references:
- https://blog.assetnote.io/2023/07/21/citrix-CVE-2023-3519-analysis/
- https://support.citrix.com/article/CTX561482/citrix-adc-and-citrix-gateway-security-bulletin-for-cve20233519-cve20233466-cve20233467
- https://securityintelligence.com/x-force/x-force-uncovers-global-netscaler-gateway-credential-harvesting-campaign/
- https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967
tags:
  analytic_story:
  - Citrix Netscaler ADC CVE-2023-3519
  cve:
  - CVE-2023-3519
  asset_type: Network
  atomic_guid: []
  confidence: 50
  impact: 90
  message: Possible expliotation of CVE-2023-3519 against $dest$.
  mitre_attack_id:
  - T1190
  observable:
  - name: dest
    type: Hostname
    role:
    - Victim
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  risk_score: 45
  required_fields:
  - _time
  - Web.http_method
  - Web.url
  - Web.url_length
  - Web.src
  - Web.dest
  security_domain: endpoint
tests:
- name: True Positive Test
  attack_data:
  - data: 
      https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/citrix/citrix-cve20233519.log
    source: pan:threat
    sourcetype: pan:threat
