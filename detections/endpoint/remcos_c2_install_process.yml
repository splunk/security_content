name: Remcos C2 install process
id: 15a1b697-929b-4b83-bf4c-18a1cdfbee1c
version: 1
date: '2021-09-23'
author: Rod Soto, Splunk
type: TTP
datamodel:
- Endpoint
description: This search detects Remcos command and control (c2) panel, by identifying process and vendor company record.
search: '`sysmon` EventCode=1 Company="BreakingSecurity.net"  |  stats  min(_time) as firstTime max(_time) as lastTime count by  Computer Description signature dest parent_process_exec process_current_directory |
`security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `remcos_c2_install_process_filter`'
how_to_implement: To successfully implement this search, you need to be ingesting
  logs with the driver loaded and Signature from your endpoints. If you are using
  Sysmon, you must have at least version 6.0.4 of the Sysmon TA.
known_false_positives: False positives should be limited.
references:
- https://attack.mitre.org/software/S0332/
tags:
  analytic_story:
  - Remcos
  confidence: 100
  context:
  - source:endpoint
  - stage: Installation
  - Persistence
  dataset:
  - https://github.com/splunk/attack_data/blob/master/datasets/malware/remcos/remcos_panel_client/remcos_c2_install_process.log
  impact: 80
  kill_chain_phases:
  - Exploitation
  message: A process $parent_process_exec$ related to installation of Remcos RAT has been detected in host $Computer$
  mitre_attack_id:
  - T1543
  observable:
  - name: Computer
    type: Hostname
    role:
    - Victim
  - name: Company
    type: Process
    role:
    - Attacker
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  required_fields:
  - _time
  - Computer
  - Description
  - parent_process_exec
  - Signature
  - process_current_directory
  risk_score: 90
  security_domain: endpoint
