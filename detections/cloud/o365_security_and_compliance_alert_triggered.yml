name: O365 Security And Compliance Alert Triggered
id: 5b367cdd-8dfc-49ac-a9b7-6406cf27f33e
version: 1
date: '2024-03-25'
author: Mauricio Velazco, Splunk
data_source: []
type: TTP
status: production
description: The following detection is tailored to identify and act upon alerts generated by the Office 365 Security and Compliance Center, encompassing a broad spectrum of security and compliance issues indicative of potential threats or policy violations within the O365 workspace.
search: ' `o365_management_activity` Workload=SecurityComplianceCenter Category=ThreatManagement Operation=AlertTriggered
  | spath input=Data path=f3u output=user
  | spath input=Data path=op output=operation | spath input=_raw path=wl 
  | spath input=Data path=rid output=rule_id 
  | spath input=Data path=ad output=alert_description 
  | spath input=Data path=lon output=operation_name 
  | spath input=Data path=an output=alert_name
  | spath input=Data path=sev output=severity
  |  stats count earliest(_time) as firstTime latest(_time) as lastTime by user, Name, operation, rule_id, alert_description, alert_name, severity
  | `security_content_ctime(firstTime)`
  | `security_content_ctime(lastTime)`
  | `o365_security_and_compliance_alert_triggered_filter`'
how_to_implement: You must install the Splunk Microsoft Office 365 Add-on and ingest Office 365 management activity events.
known_false_positives: O365 Security and Compliance may also generate false positives or trigger on legitimate behavior, filter as needed.
references:
- https://attack.mitre.org/techniques/T1078/004/
- https://learn.microsoft.com/en-us/purview/alert-policies?view=o365-worldwide
- https://learn.microsoft.com/en-us/purview/alert-policies
tags:
  analytic_story:
  - Office 365 Account Takeover
  asset_type: O365 tenant
  confidence: 80
  impact: 60
  message: Security and Compliance triggered an alert for $user$
  mitre_attack_id:
  - T1078
  - T1078.004
  observable:
  - name: user
    type: User
    role:
    - Victim
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  required_fields:
  - _time
  - Workload
  - Category
  - Operation
  - Name
  - Data
  risk_score: 48
  security_domain: identity
tests:
- name: True Positive Test
  attack_data:
  - data: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.004/o365_security_and_compliance_alert_triggered/o365_security_and_compliance_alert_triggered.log
    sourcetype: o365:management:activity
    source: o365
