name: Azure Active Directory Add member to role
id: 1660d196-127f-4678-81b2-472d51711b07
version: 1
date: '2024-07-18'
author: Patrick Bareiss, Splunk
description: Data source object for Azure Active Directory Add member to role
source: Azure AD
sourcetype: azure:monitor:aad
separator: operationName
supported_TA:
- name: Splunk Add-on for Microsoft Cloud Services
  url: https://splunkbase.splunk.com/app/3110
  version: 5.4.1
fields:
- _time
- Level
- callerIpAddress
- category
- correlationId
- date_hour
- date_mday
- date_minute
- date_month
- date_second
- date_wday
- date_year
- date_zone
- durationMs
- host
- index
- linecount
- operationName
- operationVersion
- properties.activityDateTime
- properties.activityDisplayName
- properties.category
- properties.correlationId
- properties.id
- properties.initiatedBy.user.displayName
- properties.initiatedBy.user.id
- properties.initiatedBy.user.ipAddress
- properties.initiatedBy.user.userPrincipalName
- properties.loggedByService
- properties.operationType
- properties.result
- properties.resultReason
- properties.targetResources{}.displayName
- properties.targetResources{}.id
- properties.targetResources{}.modifiedProperties{}.displayName
- properties.targetResources{}.modifiedProperties{}.newValue
- properties.targetResources{}.modifiedProperties{}.oldValue
- properties.targetResources{}.type
- properties.targetResources{}.userPrincipalName
- properties.userAgent
- punct
- resourceId
- resultSignature
- source
- sourcetype
- splunk_server
- tenantId
- time
- timeendpos
- timestartpos
example_log: '{"time": "2023-04-28T16:39:51.9312625Z", "resourceId": "/tenants/fc69e276-e9e8-4af9-9002-1e410d77244e/providers/Microsoft.aadiam",
  "operationName": "Add member to role", "operationVersion": "1.0", "category": "AuditLogs",
  "tenantId": "fc69e276-e9e8-4af9-9002-1e410d77244e", "resultSignature": "None", "durationMs":
  0, "callerIpAddress": "52.177.250.168", "correlationId": "b425f2d7-2245-4952-b599-61dff8054f2b",
  "Level": 4, "properties": {"id": "Directory_b425f2d7-2245-4952-b599-61dff8054f2b_FLAW0_72812697",
  "category": "RoleManagement", "correlationId": "b425f2d7-2245-4952-b599-61dff8054f2b",
  "result": "success", "resultReason": "", "activityDisplayName": "Add member to role",
  "activityDateTime": "2023-04-28T16:39:51.9312625+00:00", "loggedByService": "Core
  Directory", "operationType": "Assign", "userAgent": null, "initiatedBy": {"user":
  {"id": "3bd47e42-37c9-442f-a2b4-f04de61ef0ce", "displayName": null, "userPrincipalName":
  "strt_admin@splunkresearch.com", "ipAddress": "52.177.250.168", "roles": []}}, "targetResources":
  [{"id": "0d664d57-a3ee-4049-8642-280a5c7243ef", "displayName": null, "type": "User",
  "userPrincipalName": "User1@splunkresearch.com", "modifiedProperties": [{"displayName":
  "Role.ObjectID", "oldValue": null, "newValue": "\"38bf5baf-7ec7-4bc2-8920-6d4044da12c2\""},
  {"displayName": "Role.DisplayName", "oldValue": null, "newValue": "\"Privileged
  Role Administrator\""}, {"displayName": "Role.TemplateId", "oldValue": null, "newValue":
  "\"9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3\""}, {"displayName": "Role.WellKnownObjectName",
  "oldValue": null, "newValue": "\"ApplicationAdministrators\""}], "administrativeUnits":
  []}, {"id": "38bf5baf-7ec7-4bc2-8920-6d4044da12c2", "displayName": null, "type":
  "Role", "modifiedProperties": [], "administrativeUnits": []}], "additionalDetails":
  []}}'
