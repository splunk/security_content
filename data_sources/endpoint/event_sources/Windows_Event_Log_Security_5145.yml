event_name: Windows Event Log Security 5145
fields:
- _time
- AccessList
- AccessMask
- AccessReason
- Caller_Domain
- Caller_User_Name
- Channel
- Computer
- Error_Code
- EventCode
- EventData_Xml
- EventID
- EventRecordID
- Guid
- IpAddress
- IpPort
- Keywords
- Level
- Logon_ID
- Name
- ObjectType
- Opcode
- ProcessID
- RecordNumber
- RelativeTargetName
- ShareLocalPath
- ShareName
- Source_Port
- Source_Workstation
- SubjectDomainName
- SubjectLogonId
- SubjectUserName
- SubjectUserSid
- SystemTime
- System_Props_Xml
- Task
- ThreadID
- Version
- action
- app
- date_hour
- date_mday
- date_minute
- date_month
- date_second
- date_wday
- date_year
- date_zone
- dest
- dvc
- dvc_nt_host
- event_id
- eventtype
- file_name
- file_path
- host
- id
- index
- linecount
- name
- product
- punct
- session_id
- signature
- signature_id
- source
- sourcetype
- splunk_server
- src
- src_ip
- src_nt_domain
- src_nt_host
- src_port
- src_user
- status
- subject
- ta_windows_action
- tag
- tag::action
- tag::eventtype
- timeendpos
- timestartpos
- vendor
- vendor_product
field_mappings:
  - data_model: ocsf
    mapping:
      AccessList: access_list
      AccessMask: access_mask
      AccessReason: access_result
      ShareLocalPath: file.path
      RelativeTargetName: file.path
      ObjectType: file.type
      IpAddress: src_endpoint.ip
      IpPort: src_endpoint.port
      SubjectDomainName: actor.user.domain
      SubjectUserName: actor.user.name
      SubjectLogonId: actor.session.uid
      SubjectUserSid: actor.user.uid
      EventID: metadata.event_code
      ShareName: unmapped.EventData.ShareName
example_log: <Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Security-Auditing' Guid='{54849625-5478-4994-A5BA-3E3B0328C30D}'/><EventID>5145</EventID><Version>0</Version><Level>0</Level><Task>12811</Task><Opcode>0</Opcode><Keywords>0x8020000000000000</Keywords><TimeCreated SystemTime='2024-03-11T03:06:39.742608600Z'/><EventRecordID>2018939</EventRecordID><Correlation/><Execution ProcessID='4' ThreadID='304'/><Channel>Security</Channel><Computer>ar-win-dc.attackrange.local</Computer><Security/></System><EventData><Data Name='SubjectUserSid'>ANONYMOUS LOGON</Data><Data Name='SubjectUserName'>ANONYMOUS LOGON</Data><Data Name='SubjectDomainName'>ATTACKRANGE</Data><Data Name='SubjectLogonId'>0x13ef1b</Data><Data Name='ObjectType'>File</Data><Data Name='IpAddress'>10.0.1.15</Data><Data Name='IpPort'>50160</Data><Data Name='ShareName'>\\*\SYSVOL</Data><Data Name='ShareLocalPath'>\??\C:\Windows\SYSVOL\sysvol</Data><Data Name='RelativeTargetName'>lsarpc</Data><Data Name='AccessMask'>0x120089</Data><Data Name='AccessList'>%%1538
