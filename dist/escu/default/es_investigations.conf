
[panel_group://workbench_panel_group_aws_cross_account_activity]
label = AWS Cross Account Activity
description = Track when a user assumes an IAM role in another AWS account to obtain cross-account access to services and resources in that account. Accessing new roles could be an indication of malicious activity.
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_accesskeyid___response_task", "panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_aws_iam_privilege_escalation]
label = AWS IAM Privilege Escalation
description = This analytic story contains detections that query your AWS Cloudtrail for activities related to privilege escalation.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_aws_network_acl_activity]
label = AWS Network ACL Activity
description = Monitor your AWS network infrastructure for bad configurations and malicious activity. Investigative searches help you probe deeper, when the facts warrant it.
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task", "panel://workbench_panel_aws_network_acl_details_from_id___response_task", "panel://workbench_panel_aws_network_interface_details_via_resourceid___response_task", "panel://workbench_panel_get_all_aws_activity_from_ip_address___response_task", "panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_dns_traffic_ratio___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task"]

[panel_group://workbench_panel_group_aws_security_hub_alerts]
label = AWS Security Hub Alerts
description = This story is focused around detecting Security Hub alerts generated from AWS
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task", "panel://workbench_panel_get_ec2_instance_details_by_instanceid___response_task", "panel://workbench_panel_get_ec2_launch_details___response_task"]

[panel_group://workbench_panel_group_aws_user_monitoring]
label = AWS User Monitoring
description = Detect and investigate dormant user accounts for your AWS environment that have become active again. Because inactive and ad-hoc accounts are common attack targets, it's critical to enable governance within your environment.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_investigate_aws_user_activities_by_user_field___response_task"]

[panel_group://workbench_panel_group_active_directory_password_spraying]
label = Active Directory Password Spraying
description = Monitor for activities and techniques associated with Password Spraying attacks within Active Directory environments.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_apache_struts_vulnerability]
label = Apache Struts Vulnerability
description = Detect and investigate activities--such as unusually long `Content-Type` length, suspicious java classes and web servers executing suspicious processes--consistent with attempts to exploit Apache Struts vulnerabilities.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_investigate_suspicious_strings_in_http_header___response_task", "panel://workbench_panel_investigate_web_posts_from_src___response_task"]

[panel_group://workbench_panel_group_asset_tracking]
label = Asset Tracking
description = Keep a careful inventory of every asset on your network to make it easier to detect rogue devices. Unauthorized/unmanaged devices could be an indication of malicious behavior that should be investigated further.
disabled = 0

panels = ["panel://workbench_panel_get_first_occurrence_and_last_occurrence_of_a_mac_address___response_task", "panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_bits_jobs]
label = BITS Jobs
description = Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_baron_samedit_cve_2021_3156]
label = Baron Samedit CVE-2021-3156
description = Uncover activity consistent with CVE-2021-3156. Discovered by the Qualys Research Team, this vulnerability has been found to affect sudo across multiple Linux distributions (Ubuntu 20.04 and prior, Debian 10 and prior, Fedora 33 and prior). As this vulnerability was committed to code in July 2011, there will be many distributions affected. Successful exploitation of this vulnerability allows any unprivileged user to gain root privileges on the vulnerable host.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_brand_monitoring]
label = Brand Monitoring
description = Detect and investigate activity that may indicate that an adversary is using faux domains to mislead users into interacting with malicious infrastructure. Monitor DNS, email, and web traffic for permutations of your brand name.
disabled = 0

panels = ["panel://workbench_panel_get_email_info___response_task", "panel://workbench_panel_get_emails_from_specific_sender___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task"]

[panel_group://workbench_panel_group_clop_ransomware]
label = Clop Ransomware
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to the Clop ransomware, including looking for file writes associated with Clope, encrypting network shares, deleting and resizing shadow volume storage, registry key modification, deleting of security logs, and more.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_cloud_cryptomining]
label = Cloud Cryptomining
description = Monitor your cloud compute instances for activities related to cryptojacking/cryptomining. New instances that originate from previously unseen regions, users who launch abnormally high numbers of instances, or compute instances started by previously unseen users are just a few examples of potentially malicious behavior.
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_security_hub_alerts_by_dest___response_task", "panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task", "panel://workbench_panel_get_ec2_instance_details_by_instanceid___response_task", "panel://workbench_panel_get_ec2_launch_details___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_investigate_aws_activities_via_region_name___response_task"]

[panel_group://workbench_panel_group_cloud_federated_credential_abuse]
label = Cloud Federated Credential Abuse
description = This analytical story addresses events that indicate abuse of cloud federated credentials. These credentials are usually extracted from endpoint desktop or servers specially those servers that provide federation services such as Windows Active Directory Federation Services. Identity Federation relies on objects such as Oauth2 tokens, cookies or SAML assertions in order to provide seamless access between cloud and perimeter environments. If these objects are either hijacked or forged then attackers will be able to pivot into victim's cloud environements.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_cobalt_strike]
label = Cobalt Strike
description = Cobalt Strike is threat emulation software. Red teams and penetration testers use Cobalt Strike to demonstrate the risk of a breach and evaluate mature security programs. Most recently, Cobalt Strike has become the choice tool by threat groups due to its ease of use and extensibility.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_coldroot_macos_rat]
label = ColdRoot MacOS RAT
description = Leverage searches that allow you to detect and investigate unusual activities that relate to the ColdRoot Remote Access Trojan that affects MacOS. An example of some of these activities are changing sensative binaries in the MacOS sub-system, detecting process names and executables associated with the RAT, detecting when a keyboard tab is installed on a MacOS machine and more.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_investigate_network_traffic_from_src_ip___response_task"]

[panel_group://workbench_panel_group_collection_and_staging]
label = Collection and Staging
description = Monitor for and investigate activities--such as suspicious writes to the Windows Recycling Bin or email servers sending high amounts of traffic to specific hosts, for example--that may indicate that an adversary is harvesting and exfiltrating sensitive data. 
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_command_and_control]
label = Command and Control
description = Detect and investigate tactics, techniques, and procedures leveraged by attackers to establish and operate command and control channels. Implants installed by attackers on compromised endpoints use these channels to receive instructions and send data back to the malicious operators.
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task", "panel://workbench_panel_aws_network_acl_details_from_id___response_task", "panel://workbench_panel_aws_network_interface_details_via_resourceid___response_task", "panel://workbench_panel_get_all_aws_activity_from_ip_address___response_task", "panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_dns_traffic_ratio___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task"]

[panel_group://workbench_panel_group_container_implantation_monitoring_and_investigation]
label = Container Implantation Monitoring and Investigation
description = Use the searches in this story to monitor your Kubernetes registry repositories for upload, and deployment of potentially vulnerable, backdoor, or implanted containers. These searches provide information on source users, destination path, container names and repository names. The searches provide context to address Mitre T1525 which refers to container implantation upload to a company's repository either in Amazon Elastic Container Registry, Google Container Registry and Azure Container Registry.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_credential_dumping]
label = Credential Dumping
description = Uncover activity consistent with credential dumping, a technique wherein attackers compromise systems and attempt to obtain and exfiltrate passwords. The threat actors use these pilfered credentials to further escalate privileges and spread throughout a target environment. The included searches in this Analytic Story are designed to identify attempts to credential dumping.
disabled = 0

panels = ["panel://workbench_panel_investigate_failed_logins_for_multiple_destinations___response_task", "panel://workbench_panel_investigate_pass_the_hash_attempts___response_task", "panel://workbench_panel_investigate_pass_the_ticket_attempts___response_task", "panel://workbench_panel_investigate_previous_unseen_user___response_task"]

[panel_group://workbench_panel_group_dhs_report_ta18_074a]
label = DHS Report TA18-074A
description = Monitor for suspicious activities associated with DHS Technical Alert US-CERT TA18-074A. Some of the activities that adversaries used in these compromises included spearfishing attacks, malware, watering-hole domains, many and more.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_file_activity___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task"]

[panel_group://workbench_panel_group_dns_amplification_attacks]
label = DNS Amplification Attacks
description = DNS poses a serious threat as a Denial of Service (DOS) amplifier, if it responds to `ANY` queries. This Analytic Story can help you detect attackers who may be abusing your company's DNS infrastructure to launch amplification attacks, causing Denial of Service to other victims.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_dns_hijacking]
label = DNS Hijacking
description = Secure your environment against DNS hijacks with searches that help you detect and investigate unauthorized changes to DNS records.
disabled = 0

panels = ["panel://workbench_panel_dns_hijack_enrichment___response_task", "panel://workbench_panel_get_dns_server_history_for_a_host___response_task"]

[panel_group://workbench_panel_group_darkside_ransomware]
label = DarkSide Ransomware
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to the DarkSide Ransomware
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_data_exfiltration]
label = Data Exfiltration
description = The stealing of data by an adversary.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_data_protection]
label = Data Protection
description = Fortify your data-protection arsenal--while continuing to ensure data confidentiality and integrity--with searches that monitor for and help you investigate possible signs of data exfiltration.
disabled = 0

panels = ["panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_dns_traffic_ratio___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task"]

[panel_group://workbench_panel_group_deobfuscate_decode_files_or_information]
label = Deobfuscate-Decode Files or Information
description = Adversaries may use Obfuscated Files or Information to hide artifacts of an intrusion from analysis.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_detect_zerologon_attack]
label = Detect Zerologon Attack
description = Uncover activity related to the execution of Zerologon CVE-2020-11472, a technique wherein attackers target a Microsoft Windows Domain Controller to reset its computer account password. The result from this attack is attackers can now provide themselves high privileges and take over Domain Controller. The included searches in this Analytic Story are designed to identify attempts to reset Domain Controller Computer Account via exploit code remotely or via the use of tool Mimikatz as payload carrier.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_disabling_security_tools]
label = Disabling Security Tools
description = Looks for activities and techniques associated with the disabling of security tools on a Windows system, such as suspicious `reg.exe` processes, processes launching netsh, and many others.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_domain_trust_discovery]
label = Domain Trust Discovery
description = Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_dynamic_dns]
label = Dynamic DNS
description = Detect and investigate hosts in your environment that may be communicating with dynamic domain providers. Attackers may leverage these services to help them avoid firewall blocks and deny lists.
disabled = 0

panels = ["panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_dns_traffic_ratio___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task"]

[panel_group://workbench_panel_group_emotet_malware__dhs_report_ta18_201a_]
label = Emotet Malware  DHS Report TA18-201A 
description = Detect rarely used executables, specific registry paths that may confer malware survivability and persistence, instances where cmd.exe is used to launch script interpreters, and other indicators that the Emotet financial malware has compromised your environment.
disabled = 0

panels = ["panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task"]

[panel_group://workbench_panel_group_f5_tmui_rce_cve_2020_5902]
label = F5 TMUI RCE CVE-2020-5902
description = Uncover activity consistent with CVE-2020-5902. Discovered by Positive Technologies researchers, this vulnerability affects F5 BIG-IP, BIG-IQ. and Traffix SDC devices (vulnerable versions in F5 support link below). This vulnerability allows unauthenticated users, along with authenticated users, who have access to the configuration utility to execute system commands, create/delete files, disable services, and/or execute Java code.  This vulnerability can result in full system compromise.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_gcp_cross_account_activity]
label = GCP Cross Account Activity
description = Track when a user assumes an IAM role in another GCP account to obtain cross-account access to services and resources in that account. Accessing new roles could be an indication of malicious activity.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_hafnium_group]
label = HAFNIUM Group
description = HAFNIUM group was identified by Microsoft as exploiting 4 Microsoft Exchange CVEs in the wild - CVE-2021-26855, CVE-2021-26857, CVE-2021-26858 and CVE-2021-27065.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_hidden_cobra_malware]
label = Hidden Cobra Malware
description = Monitor for and investigate activities, including the creation or deletion of hidden shares and file writes, that may be evidence of infiltration by North Korean government-sponsored cybercriminals. Details of this activity were reported in DHS Report TA-18-149A.
disabled = 0

panels = ["panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_dns_traffic_ratio___response_task", "panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_outbound_emails_to_hidden_cobra_threat_actors___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task", "panel://workbench_panel_investigate_successful_remote_desktop_authentications___response_task"]

[panel_group://workbench_panel_group_ingress_tool_transfer]
label = Ingress Tool Transfer
description = Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_jboss_vulnerability]
label = JBoss Vulnerability
description = In March of 2016, adversaries were seen using JexBoss--an open-source utility used for testing and exploiting JBoss application servers. These searches help detect evidence of these attacks, such as network connections to external resources or web services spawning atypical child processes, among others.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_kubernetes_scanning_activity]
label = Kubernetes Scanning Activity
description = This story addresses detection against Kubernetes cluster fingerprint scan and attack by providing information on items such as source ip, user agent, cluster names.
disabled = 0

panels = ["panel://workbench_panel_amazon_eks_kubernetes_activity_by_src_ip___response_task", "panel://workbench_panel_gcp_kubernetes_activity_by_src_ip___response_task", "panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_kubernetes_sensitive_object_access_activity]
label = Kubernetes Sensitive Object Access Activity
description = This story addresses detection and response of accounts acccesing Kubernetes cluster sensitive objects such as configmaps or secrets providing information on items such as user user, group. object, namespace and authorization reason.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_lateral_movement]
label = Lateral Movement
description = Detect and investigate tactics, techniques, and procedures around how attackers move laterally within the enterprise. Because lateral movement can expose the adversary to detection, it should be an important focus for security analysts.
disabled = 0

panels = ["panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task", "panel://workbench_panel_investigate_successful_remote_desktop_authentications___response_task"]

[panel_group://workbench_panel_group_malicious_powershell]
label = Malicious PowerShell
description = Attackers are finding stealthy ways "live off the land," leveraging utilities and tools that come standard on the endpoint--such as PowerShell--to achieve their goals without downloading binary files. These searches can help you detect and investigate PowerShell command-line options that may be indicative of malicious intent.
disabled = 0

panels = ["panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_masquerading___rename_system_utilities]
label = Masquerading - Rename System Utilities
description = Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_meterpreter]
label = Meterpreter
description = Meterpreter provides red teams, pen testers and threat actors interactive access to a compromised host to run commands, upload payloads, download files, and other actions.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_monitor_for_updates]
label = Monitor for Updates
description = Monitor your enterprise to ensure that your endpoints are being patched and updated. Adversaries notoriously exploit known vulnerabilities that could be mitigated by applying routine security patches.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_nobelium_group]
label = NOBELIUM Group
description = Sunburst is a trojanized updates to SolarWinds Orion IT monitoring and management software. It was discovered by FireEye in December 2020. The actors behind this campaign gained access to numerous public and private organizations around the world.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_netsh_abuse]
label = Netsh Abuse
description = Detect activities and various techniques associated with the abuse of `netsh.exe`, which can disable local firewall settings or set up a remote connection to a host from an infected system.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_office_365_detections]
label = Office 365 Detections
description = This story is focused around detecting Office 365 Attacks.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_orangeworm_attack_group]
label = Orangeworm Attack Group
description = Detect activities and various techniques associated with the Orangeworm Attack Group, a group that frequently targets the healthcare industry.
disabled = 0

panels = ["panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_possible_backdoor_activity_associated_with_mudcarp_espionage_campaigns]
label = Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns
description = Monitor your environment for suspicious behaviors that resemble the techniques employed by the MUDCARP threat group.
disabled = 0

panels = ["panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_prohibited_traffic_allowed_or_protocol_mismatch]
label = Prohibited Traffic Allowed or Protocol Mismatch
description = Detect instances of prohibited network traffic allowed in the environment, as well as protocols running on non-standard ports. Both of these types of behaviors typically violate policy and can be leveraged by attackers.
disabled = 0

panels = ["panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task"]

[panel_group://workbench_panel_group_ransomware]
label = Ransomware
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to ransomware--spikes in SMB traffic, suspicious wevtutil usage, the presence of common ransomware extensions, and system processes run from unexpected locations, and many others.
disabled = 0

panels = ["panel://workbench_panel_get_backup_logs_for_endpoint___response_task", "panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task", "panel://workbench_panel_get_sysmon_wmi_activity_for_host___response_task"]

[panel_group://workbench_panel_group_ransomware_cloud]
label = Ransomware Cloud
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to ransomware. These searches include cloud related objects that may be targeted by malicious actors via cloud providers own encryption features.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_revil_ransomware]
label = Revil Ransomware
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to the Revil ransomware, including looking for file writes associated with Revil, encrypting network shares, deleting shadow volume storage, registry key modification, deleting of security logs, and more.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_router_and_infrastructure_security]
label = Router and Infrastructure Security
description = Validate the security configuration of network infrastructure and verify that only authorized users and systems are accessing critical assets. Core routing and switching infrastructure are common strategic targets for attackers.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_ryuk_ransomware]
label = Ryuk Ransomware
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to the Ryuk ransomware, including looking for file writes associated with Ryuk, Stopping Security Access Manager, DisableAntiSpyware registry key modification, suspicious psexec use, and more.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_sql_injection]
label = SQL Injection
description = Use the searches in this Analytic Story to help you detect structured query language (SQL) injection attempts characterized by long URLs that contain malicious parameters.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_samsam_ransomware]
label = SamSam Ransomware
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to the SamSam ransomware, including looking for file writes associated with SamSam, RDP brute force attacks, the presence of files with SamSam ransomware extensions, suspicious psexec use, and more.
disabled = 0

panels = ["panel://workbench_panel_get_backup_logs_for_endpoint___response_task", "panel://workbench_panel_get_history_of_email_sources___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task", "panel://workbench_panel_investigate_successful_remote_desktop_authentications___response_task"]

[panel_group://workbench_panel_group_silver_sparrow]
label = Silver Sparrow
description = Silver Sparrow, identified by Red Canary Intelligence, is a new forward looking MacOS (Intel and M1) malicious software downloader utilizing JavaScript for execution and a launchAgent to establish persistence.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_spearphishing_attachments]
label = Spearphishing Attachments
description = Detect signs of malicious payloads that may indicate that your environment has been breached via a phishing attack.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_suspicious_aws_login_activities]
label = Suspicious AWS Login Activities
description = Monitor your AWS authentication events using your CloudTrail logs. Searches within this Analytic Story will help you stay aware of and investigate suspicious logins. 
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task"]

[panel_group://workbench_panel_group_suspicious_aws_s3_activities]
label = Suspicious AWS S3 Activities
description = Use the searches in this Analytic Story to monitor your AWS S3 buckets for evidence of anomalous activity and suspicious behaviors, such as detecting open S3 buckets and buckets being accessed from a new IP. The contextual and investigative searches will give you more information, when required.
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task", "panel://workbench_panel_aws_s3_bucket_details_via_bucketname___response_task", "panel://workbench_panel_get_all_aws_activity_from_ip_address___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_investigate_aws_activities_via_region_name___response_task"]

[panel_group://workbench_panel_group_suspicious_aws_traffic]
label = Suspicious AWS Traffic
description = Leverage these searches to monitor your AWS network traffic for evidence of anomalous activity and suspicious behaviors, such as a spike in blocked outbound traffic in your virtual private cloud (VPC).
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task", "panel://workbench_panel_aws_network_acl_details_from_id___response_task", "panel://workbench_panel_aws_network_interface_details_via_resourceid___response_task", "panel://workbench_panel_get_all_aws_activity_from_ip_address___response_task", "panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_dns_traffic_ratio___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task"]

[panel_group://workbench_panel_group_suspicious_cloud_authentication_activities]
label = Suspicious Cloud Authentication Activities
description = Monitor your cloud authentication events. Searches within this Analytic Story leverage the recent cloud updates to the Authentication data model to help you stay aware of and investigate suspicious login activity. 
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_investigate_aws_user_activities_by_user_field___response_task"]

[panel_group://workbench_panel_group_suspicious_cloud_instance_activities]
label = Suspicious Cloud Instance Activities
description = Monitor your cloud infrastructure provisioning activities for behaviors originating from unfamiliar or unusual locations. These behaviors may indicate that malicious activities are occurring somewhere within your cloud environment.
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task", "panel://workbench_panel_get_all_aws_activity_from_ip_address___response_task"]

[panel_group://workbench_panel_group_suspicious_cloud_provisioning_activities]
label = Suspicious Cloud Provisioning Activities
description = Monitor your cloud infrastructure provisioning activities for behaviors originating from unfamiliar or unusual locations. These behaviors may indicate that malicious activities are occurring somewhere within your cloud environment.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_suspicious_cloud_user_activities]
label = Suspicious Cloud User Activities
description = Detect and investigate suspicious activities by users and roles in your cloud environments.
disabled = 0

panels = ["panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task"]

[panel_group://workbench_panel_group_suspicious_command_line_executions]
label = Suspicious Command-Line Executions
description = Leveraging the Windows command-line interface (CLI) is one of the most common attack techniques--one that is also detailed in the MITRE ATT&CK framework. Use this Analytic Story to help you identify unusual or suspicious use of the CLI on Windows systems.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_suspicious_dns_traffic]
label = Suspicious DNS Traffic
description = Attackers often attempt to hide within or otherwise abuse the domain name system (DNS). You can thwart attempts to manipulate this omnipresent protocol by monitoring for these types of abuses.
disabled = 0

panels = ["panel://workbench_panel_get_dns_server_history_for_a_host___response_task", "panel://workbench_panel_get_dns_traffic_ratio___response_task", "panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task"]

[panel_group://workbench_panel_group_suspicious_emails]
label = Suspicious Emails
description = Email remains one of the primary means for attackers to gain an initial foothold within the modern enterprise. Detect and investigate suspicious emails in your environment with the help of the searches in this Analytic Story.
disabled = 0

panels = ["panel://workbench_panel_get_email_info___response_task", "panel://workbench_panel_get_emails_from_specific_sender___response_task", "panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_suspicious_gcp_storage_activities]
label = Suspicious GCP Storage Activities
description = Use the searches in this Analytic Story to monitor your GCP Storage buckets for evidence of anomalous activity and suspicious behaviors, such as detecting open storage buckets and buckets being accessed from a new IP. The contextual and investigative searches will give you more information, when required.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_suspicious_mshta_activity]
label = Suspicious MSHTA Activity
description = Monitor and detect techniques used by attackers who leverage the mshta.exe process to execute malicious code.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_suspicious_okta_activity]
label = Suspicious Okta Activity
description = Monitor your Okta environment for suspicious activities. Due to the Covid outbreak, many users are migrating over to leverage cloud services more and more. Okta is a popular tool to manage multiple users and the web-based applications they need to stay productive. The searches in this story will help monitor your Okta environment for suspicious activities and associated user behaviors.
disabled = 0

panels = ["panel://workbench_panel_investigate_okta_activity_by_ip_address___response_task", "panel://workbench_panel_investigate_okta_activity_by_app___response_task", "panel://workbench_panel_investigate_user_activities_in_okta___response_task"]

[panel_group://workbench_panel_group_suspicious_regsvr32_activity]
label = Suspicious Regsvr32 Activity
description = Monitor and detect techniques used by attackers who leverage the regsvr32.exe process to execute malicious code.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_suspicious_rundll32_activity]
label = Suspicious Rundll32 Activity
description = Monitor and detect techniques used by attackers who leverage rundll32.exe to execute arbitrary malicious code.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_suspicious_wmi_use]
label = Suspicious WMI Use
description = Attackers are increasingly abusing Windows Management Instrumentation (WMI), a framework and associated utilities available on all modern Windows operating systems. Because WMI can be leveraged to manage both local and remote systems, it is important to identify the processes executed and the user context within which the activity occurred.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task", "panel://workbench_panel_get_sysmon_wmi_activity_for_host___response_task"]

[panel_group://workbench_panel_group_suspicious_windows_registry_activities]
label = Suspicious Windows Registry Activities
description = Monitor and detect registry changes initiated from remote locations, which can be a sign that an attacker has infiltrated your system.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_suspicious_zoom_child_processes]
label = Suspicious Zoom Child Processes
description = Attackers are using Zoom as an vector to increase privileges on a sytems. This story detects new child processes of zoom and provides investigative actions for this detection.
disabled = 0

panels = ["panel://workbench_panel_get_process_file_activity___response_task"]

[panel_group://workbench_panel_group_trickbot]
label = Trickbot
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to the trickbot banking trojan, including looking for file writes associated with its payload, process injection, shellcode execution and data collection even in LDAP environment.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_trusted_developer_utilities_proxy_execution]
label = Trusted Developer Utilities Proxy Execution
description = Monitor and detect behaviors used by attackers who leverage trusted developer utilities to execute malicious code.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_trusted_developer_utilities_proxy_execution_msbuild]
label = Trusted Developer Utilities Proxy Execution MSBuild
description = Monitor and detect techniques used by attackers who leverage the msbuild.exe process to execute malicious code.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_unusual_processes]
label = Unusual Processes
description = Quickly identify systems running new or unusual processes in your environment that could be indicators of suspicious activity. Processes run from unusual locations, those with conspicuously long command lines, and rare executables are all examples of activities that may warrant deeper investigation.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_use_of_cleartext_protocols]
label = Use of Cleartext Protocols
description = Leverage searches that detect cleartext network protocols that may leak credentials or should otherwise be encrypted.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_process_information_for_port_activity___response_task"]

[panel_group://workbench_panel_group_windows_dns_sigred_cve_2020_1350]
label = Windows DNS SIGRed CVE-2020-1350
description = Uncover activity consistent with CVE-2020-1350, or SIGRed. Discovered by Checkpoint researchers, this vulnerability affects Windows 2003 to 2019, and is triggered by a malicious DNS response (only affects DNS over TCP). An attacker can use the malicious payload to cause a buffer overflow on the vulnerable system, leading to compromise.  The included searches in this Analytic Story are designed to identify the large response payload for SIG and KEY DNS records which can be used for the exploit.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]

[panel_group://workbench_panel_group_windows_defense_evasion_tactics]
label = Windows Defense Evasion Tactics
description = Detect tactics used by malware to evade defenses on Windows endpoints. A few of these include suspicious `reg.exe` processes, files hidden with `attrib.exe` and disabling user-account control, among many others 
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_windows_file_extension_and_association_abuse]
label = Windows File Extension and Association Abuse
description = Detect and investigate suspected abuse of file extensions and Windows file associations. Some of the malicious behaviors involved may include inserting spaces before file extensions or prepending the file extension with a different one, among other techniques.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_windows_log_manipulation]
label = Windows Log Manipulation
description = Adversaries often try to cover their tracks by manipulating Windows logs. Use these searches to help you monitor for suspicious activity surrounding log files--an essential component of an effective defense.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_windows_persistence_techniques]
label = Windows Persistence Techniques
description = Monitor for activities and techniques associated with maintaining persistence on a Windows system--a sign that an adversary may have compromised your environment.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_windows_privilege_escalation]
label = Windows Privilege Escalation
description = Monitor for and investigate activities that may be associated with a Windows privilege-escalation attack, including unusual processes running on endpoints, modified registry keys, and more.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_windows_service_abuse]
label = Windows Service Abuse
description = Windows services are often used by attackers for persistence and the ability to load drivers or otherwise interact with the Windows kernel. This Analytic Story helps you monitor your environment for indications that Windows services are being modified or created in a suspicious manner.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task", "panel://workbench_panel_get_parent_process_info___response_task", "panel://workbench_panel_get_process_info___response_task"]

[panel_group://workbench_panel_group_xmrig]
label = XMRig
description = Leverage searches that allow you to detect and investigate unusual activities that might relate to the xmrig monero, including looking for file writes associated with its payload, process command-line, defense evasion (killing services, deleting users, modifying files or folder permission, killing other malware or other coin miner) and hacking tools including Telegram as mean of command and control (C2) to download other files. Adversaries may leverage the resources of co-opted systems in order to solve resource intensive problems which may impact system and/or hosted service availability. One common purpose for Resource Hijacking is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive. (1) Servers and cloud-based (2) systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for Resource Hijacking and cryptocurrency mining.
disabled = 0

panels = ["panel://workbench_panel_get_notable_history___response_task"]



[panel://workbench_panel_aws_investigate_security_hub_alerts_by_dest___response_task]
label = AWS Investigate Security Hub alerts by dest
description = This search retrieves the all the alerts created by AWS Security Hub for a specific dest(instance_id).
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_aws_investigate_user_activities_by_arn___response_task]
label = AWS Investigate User Activities By ARN
description = This search lists all the logged CloudTrail activities by a specific user ARN and will create a table containing the source of the user, the region of the activity, the name and type of the event, the action taken, and all the user's identity information.
disabled = 0
tokens = {\
    "user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR user=",\
      "valueType": "primitive",\
      "value": "identity",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_aws_investigate_user_activities_by_accesskeyid___response_task]
label = AWS Investigate User Activities By AccessKeyId
description = This search retrieves the times, ARN, source IPs, AWS regions, event names, and the result of the event for specific credentials.
disabled = 0
tokens = {\
    "accessKeyId": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR accessKeyId=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_aws_network_acl_details_from_id___response_task]
label = AWS Network ACL Details from ID
description = This search queries AWS description logs and returns all the information about a specific network ACL via network ACL ID
disabled = 0
tokens = {\
    "networkAclId": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR networkAclId=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_aws_network_interface_details_via_resourceid___response_task]
label = AWS Network Interface details via resourceId
description = This search queries AWS configuration logs and returns the information about a specific network interface via network interface ID. The information will include the ARN of the network interface, its relationships with other AWS resources, the public and the private IP associated with the network interface.
disabled = 0
tokens = {\
    "resourceId": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR resourceId=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_aws_s3_bucket_details_via_bucketname___response_task]
label = AWS S3 Bucket details via bucketName
description = This search queries AWS configuration logs and returns the information about a specific S3 bucket. The information returned includes the time the S3 bucket was created, the resource ID, the region it belongs to, the value of action performed, AWS account ID, and configuration values of the access-control lists associated with the bucket.
disabled = 0
tokens = {\
    "bucketName": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR bucketName=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_all_backup_logs_for_host___response_task]
label = All backup logs for host
description = Retrieve the backup logs for the last 2 weeks for a specific host in order to investigate why backups are not completing successfully.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_amazon_eks_kubernetes_activity_by_src_ip___response_task]
label = Amazon EKS Kubernetes activity by src ip
description = This search provides investigation data about requests via user agent, authentication request URI, verb and cluster name data against Kubernetes cluster from a specific IP address
disabled = 0
tokens = {\
    "src_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_gcp_kubernetes_activity_by_src_ip___response_task]
label = GCP Kubernetes activity by src ip
description = This search provides investigation data about requests via user agent, authentication request URI, resource path and cluster name data against Kubernetes cluster from a specific IP address
disabled = 0
tokens = {\
    "src_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_all_aws_activity_from_city___response_task]
label = Get All AWS Activity From City
description = This search retrieves all the activity from a specific city and will create a table containing the time, city, ARN, username, the type of user, the source IP address, the AWS region the activity was in, the API called, and whether or not the API call was successful.
disabled = 0
tokens = {\
    "City": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR City=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_all_aws_activity_from_country___response_task]
label = Get All AWS Activity From Country
description = This search retrieves all the activity from a specific country and will create a table containing the time, country, ARN, username, the type of user, the source IP address, the AWS region the activity was in, the API called, and whether or not the API call was successful.
disabled = 0
tokens = {\
    "Country": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR Country=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_all_aws_activity_from_ip_address___response_task]
label = Get All AWS Activity From IP Address
description = This search retrieves all the activity from a specific IP address and will create a table containing the time, ARN, username, the type of user, the IP address, the AWS region the activity was in, the API called, and whether or not the API call was successful.
disabled = 0
tokens = {\
    "src_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_all_aws_activity_from_region___response_task]
label = Get All AWS Activity From Region
description = This search retrieves all the activity from a specific geographic region and will create a table containing the time, geographic region, ARN, username, the type of user, the source IP address, the AWS region the activity was in, the API called, and whether or not the API call was successful.
disabled = 0
tokens = {\
    "Region": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR Region=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_backup_logs_for_endpoint___response_task]
label = Get Backup Logs For Endpoint
description = This search will tell you the backup status from your netbackup_logs of a specific endpoint for the last week.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_certificate_logs_for_a_domain___response_task]
label = Get Certificate logs for a domain
description = This search queries the Certificates datamodel and give you all the information for a specific domain. Please note that the certificates issued by "Let's Encrypt" are widely used by attackers.
disabled = 0
tokens = {\
    "domain": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR domain=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_dns_server_history_for_a_host___response_task]
label = Get DNS Server History for a host
description = While investigating any detections it is important to understand which and how many DNS servers a host has connected to in the past. This search uses data that is tagged as DNS and gives you a count and list of DNS servers that a particular host has connected to the previous 24 hours.
disabled = 0
tokens = {\
    "src_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_dns_traffic_ratio___response_task]
label = Get DNS traffic ratio
description = This search calculates the ratio of DNS traffic originating and coming from a host to a list of DNS servers over the last 24 hours. A high value of this ratio could be very useful to quickly understand if a src_ip (host) is sending a high volume of data out via port 53, could be an indicator of data exfiltration via DNS.  
disabled = 0
tokens = {\
    "src_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "dest_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_ec2_instance_details_by_instanceid___response_task]
label = Get EC2 Instance Details by instanceId
description = This search queries AWS description logs and returns all the information about a specific instance via the instanceId field
disabled = 0
tokens = {\
    "instanceId": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR instanceId=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_ec2_launch_details___response_task]
label = Get EC2 Launch Details
description = This search returns some of the launch details for a EC2 instance.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_email_info___response_task]
label = Get Email Info
description = This search returns all the information Splunk might have collected a specific email message over the last 2 hours.
disabled = 0
tokens = {\
    "message_id": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR message_id=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_emails_from_specific_sender___response_task]
label = Get Emails From Specific Sender
description = This search returns all the emails from a specific sender over the last 24 and next hours.
disabled = 0
tokens = {\
    "src_user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_user=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_first_occurrence_and_last_occurrence_of_a_mac_address___response_task]
label = Get First Occurrence and Last Occurrence of a MAC Address
description = This search allows you to gather more context around a notable which has detected a new device connecting to your network. Use this search to determine the first and last occurrences of the suspicious device attempting to connect with your network.
disabled = 0
tokens = {\
    "src_mac": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_mac=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_history_of_email_sources___response_task]
label = Get History Of Email Sources
description = This search returns a list of all email sources seen in the 48 hours prior to the notable event to 24 hours after, and the number of emails from each source.
disabled = 0
tokens = {\
    "src": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_logon_rights_modifications_for_endpoint___response_task]
label = Get Logon Rights Modifications For Endpoint
description = This search allows you to retrieve any modifications to logon rights associated with a specific host.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_logon_rights_modifications_for_user___response_task]
label = Get Logon Rights Modifications For User
description = This search allows you to retrieve any modifications to logon rights for a specific user account.
disabled = 0
tokens = {\
    "user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR user=",\
      "valueType": "primitive",\
      "value": "identity",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_notable_history___response_task]
label = Get Notable History
description = This search queries the notable index and returns all the Notable Events for the particular destination host, giving the analyst an overview of the incidents that may have occurred with the host under investigation.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_outbound_emails_to_hidden_cobra_threat_actors___response_task]
label = Get Outbound Emails to Hidden Cobra Threat Actors
description = This search returns the information of the users that sent emails to the accounts controlled by the Hidden Cobra Threat Actors: specifically to `misswang8107@gmail.com`, and from `redhat@gmail.com`.
disabled = 0
tokens = {\
    "src_user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_user=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "recipient": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR recipient=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_parent_process_info___response_task]
label = Get Parent Process Info
description = This search queries the Endpoint data model to give you details about the parent process of a process running on a host which is under investigation. Enter the values of the process name in question and the dest
disabled = 0
tokens = {\
    "parent_process_name": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR parent_process_name=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_process_file_activity___response_task]
label = Get Process File Activity
description = This search returns the file activity for a specific process on a specific endpoint
disabled = 0
tokens = {\
    "process_name": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR process_name=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_process_info___response_task]
label = Get Process Info
description = This search queries the Endpoint data model to give you details about the process running on a host which is under investigation. To gather the process info, enter the values for the process name in question and the destination IP address.
disabled = 0
tokens = {\
    "process_name": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR process_name=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_process_information_for_port_activity___response_task]
label = Get Process Information For Port Activity
description = This search will return information about the process associated with observed network traffic to a specific destination port from a specific host.
disabled = 0
tokens = {\
    "dest_port": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest_port=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_process_responsible_for_the_dns_traffic___response_task]
label = Get Process Responsible For The DNS Traffic
description = While investigating, an analyst will want to know what process and parent_process is responsible for generating suspicious DNS traffic. Use the following search and enter the value of `dest` in the search to get specific details on the process responsible for creating the DNS traffic.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_sysmon_wmi_activity_for_host___response_task]
label = Get Sysmon WMI Activity for Host
description = This search queries Sysmon WMI events for the host of interest.
disabled = 0
tokens = {\
    "process": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR process=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_get_web_session_information_via_session_id___response_task]
label = Get Web Session Information via session id
description = This search helps an analyst investigate a notable event to find out more about a specific web session. The search looks for a specific web session ID in the HTTP web traffic and outputs the URL and user agents, grouped by source IP address and HTTP status code.
disabled = 0
tokens = {\
    "session_id": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR session_id=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_aws_user_activities_by_user_field___response_task]
label = Investigate AWS User Activities by user field
description = This search lists all the logged CloudTrail activities by a specific user and will create a table containing the source of the user, the region of the activity, the name and type of the event, the action taken, and the user's identity information.
disabled = 0
tokens = {\
    "user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR user=",\
      "valueType": "primitive",\
      "value": "identity",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_aws_activities_via_region_name___response_task]
label = Investigate AWS activities via region name
description = This search lists all the user activities logged by CloudTrail for a specific region in question and will create a table of the values of parameters requested, the type of the event and the response from the AWS API by each user
disabled = 0
tokens = {\
    "vendor_region": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR vendor_region=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_failed_logins_for_multiple_destinations___response_task]
label = Investigate Failed Logins for Multiple Destinations
description = This search returns failed logins to multiple destinations by user.
disabled = 0
tokens = {\
    "user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR user=",\
      "valueType": "primitive",\
      "value": "identity",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_network_traffic_from_src_ip___response_task]
label = Investigate Network Traffic From src ip
description = This search allows you to find all the network traffic from a specific IP address.
disabled = 0
tokens = {\
    "src_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_okta_activity_by_ip_address___response_task]
label = Investigate Okta Activity by IP Address
description = This search returns all okta events from a specific IP address.
disabled = 0
tokens = {\
    "user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR user=",\
      "valueType": "primitive",\
      "value": "identity",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_okta_activity_by_app___response_task]
label = Investigate Okta Activity by app
description = This search returns all okta events associated with a specific app
disabled = 0
tokens = {\
    "app": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR app=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_pass_the_hash_attempts___response_task]
label = Investigate Pass the Hash Attempts
description = This search hunts for dumped NTLM hashes used for pass the hash.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_pass_the_ticket_attempts___response_task]
label = Investigate Pass the Ticket Attempts
description = This search hunts for dumped kerberos ticket from LSASS memory.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_previous_unseen_user___response_task]
label = Investigate Previous Unseen User
description = This search returns previous unseen user, which didn't log in for 30 days.
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_successful_remote_desktop_authentications___response_task]
label = Investigate Successful Remote Desktop Authentications
description = This search returns the source, destination, and user for all successful remote-desktop authentications. A successful authentication after a brute-force attack on a destination machine is suspicious behavior. 
disabled = 0
tokens = {\
    "dest": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest=",\
      "valueType": "primitive",\
      "value": "asset",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_suspicious_strings_in_http_header___response_task]
label = Investigate Suspicious Strings in HTTP Header
description = This search helps an analyst investigate a notable event related to a potential Apache Struts exploitation. To investigate, we will want to isolate and analyze the "payload" or the commands that were passed to the vulnerable hosts by creating a few regular expressions to carve out the commands focusing on common keywords from the payload, such as cmd.exe, /bin/bash and whois. The search returns these suspicious strings found in the HTTP logs of the system of interest.
disabled = 0
tokens = {\
    "src_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    },\
    "dest_ip": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR dest_ip=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_user_activities_in_okta___response_task]
label = Investigate User Activities In Okta
description = This search returns all okta events by a specific user
disabled = 0
tokens = {\
    "user": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR user=",\
      "valueType": "primitive",\
      "value": "identity",\
      "default": "null"\
    }\
}\


[panel://workbench_panel_investigate_web_posts_from_src___response_task]
label = Investigate Web POSTs From src
description = This investigative search retrieves POST requests from a specified source IP or hostname. Identifying the POST requests, as well as their associated destination URLs and user agent(s), may help you scope and characterize the suspicious traffic. 
disabled = 0
tokens = {\
    "src": {\
      "valuePrefix": "\"",\
      "valueSuffix": "\"",\
      "delimiter": " OR src=",\
      "valueType": "primitive",\
      "value": "file",\
      "default": "null"\
    }\
}\


