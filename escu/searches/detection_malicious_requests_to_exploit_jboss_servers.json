{
    "asset_type": "Web Server",
    "channel": "ESCU",
    "confidence": "high",
    "correlation_rule": {
        "notable": {
            "nes_fields": "src, dest_ip",
            "rule_description": "A search for detecting malicious requests made to exploit jmx-console in JBoss servers. The bad requests have a long url length since it serves the payload via the url",
            "rule_title": "Detected malicious requests to exploit JBoss servers"
        },
        "risk": {
            "risk_object": "dest",
            "risk_object_type": ["system"],
            "risk_score": 80
        },
        "suppress": {
            "suppress_fields": "dest,url,src",
            "suppress_period": "14400s"
        }
    },
    "creation_date": "2016-10-04",
    "data_metadata": {
        "data_models": [
            "Web"
        ],
        "data_source": [
            "Network Communications",
            "Web Server"
        ],
        "providing_technologies": [
            "Splunk Stream",
            "Palo Alto Firewall",
            "Apache",
            "Bro"
        ]
    },
    "eli5": "This search looks for HTTP requests for a URL that has been used to exploit JBoss servers.",
    "how_to_implement": "You must ingest data from the web server or capture network data that contains web specific information with solutions such as Bro or Splunk Stream, and populating the Web data model",
    "known_false_positives": "No known false positives for this detection.",
    "maintainers": [
        {
            "company": "Splunk",
            "email": "bpatel@splunk.com",
            "name": "Bhavin Patel"
        }
    ],
    "mappings": {
        "cis20": [
            "CIS 12",
            "CIS 4",
            "CIS 18"
        ],
        "kill_chain_phases": [
            "Delivery"
        ],
        "mitre_attack": [
            "Defense Evasion",
            "Exploitation of Vulnerability"
        ],
        "nist": [
            "ID.RA",
            "PR.PT",
            "PR.IP",
            "DE.AE",
            "PR.MA",
            "DE.CM"
        ]
    },
    "modification_date": "2017-09-23",
    "original_authors": [
        {
            "company": "Splunk",
            "email": "bpatel@splunk.com",
            "name": "Bhavin Patel"
        }
    ],
    "scheduling": {
        "cron_schedule": "0 * * * *",
        "earliest_time": "-70m@m",
        "latest_time": "-10m@m"
    },
    "search": "| tstats `summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where (Web.http_method=\"GET\" OR Web.http_method=\"HEAD\") by Web.http_method, Web.url,Web.url_length Web.src, Web.dest | search Web.url=\"*jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.admin*import*\" AND Web.url_length > 200 | `drop_dm_object_name(\"Web\")` | `ctime(firstTime)` | `ctime(lastTime)` | table src, dest_ip, http_method, url, firstTime, lastTime",
    "search_description": "This search is used to detect malicious HTTP requests crafted to exploit jmx-console in JBoss servers. The malicious requests have a long URL length, as the payload is embedded in the URL.",
    "search_id": "c8bff7a4-11ea-4416-a27d-c5bca472913d",
    "search_name": "Detect malicious requests to exploit JBoss servers",
    "search_type": "detection",
    "security_domain": "network",
    "spec_version": 1,
    "version": "1.0"
}
