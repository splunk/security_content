{
    "asset_type": "Endpoint",
    "channel": "ESCU",
    "confidence": "high",
    "correlation_rule": {
        "notable": {
            "nes_fields": "dest, file_name",
            "rule_description": "A file modification was detected on $dest$ with an extension commonly used by ransomware.",
            "rule_title": "Ransomware Extension detected on $dest$"
        },
        "risk": {
            "risk_object": "dest",
            "risk_object_type": ["system"],
            "risk_score": 80
        },
        "suppress": {
            "suppress_fields": "dest,file_name",
            "suppress_period": "14400s"
        }
    },
    "creation_date": "2017-08-21",
    "data_metadata": {
        "data_models": [
            "Endpoint"
        ],
        "data_source": [
            "Endpoint Intel"
        ],
        "providing_technologies": [
            "Carbon Black Response",
            "CrowdStrike Falcon",
            "Sysmon"
        ]
    },
    "eli5": "This search looks at file modifications across your hosts and identifies files with extensions that are commonly associated with the encrypted files generated by ransomware.",

    "how_to_implement": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",

    "known_false_positives": "It is possible for a legitimate file with these extensions to be created. If this is a true ransomware attack, there will be a large number of files created with these extensions.",
    "maintainers": [
        {
            "company": "Splunk",
            "email": "davidd@splunk.com",
            "name": "David Dorsey"
        },{
            "company": "Splunk",
            "email": "bpatel@splunk.com",
            "name": "Bhavin Patel"
        }
    ],
    "mappings": {
        "cis20": [
            "CIS 8"
        ],
        "kill_chain_phases": [
            "Actions on Objectives"
        ],
        "mitre_attack": [],
        "nist": [
            "PR.PT",
            "DE.CM"
        ]
    },
   "modification_date": "2018-11-15",

    "original_authors": [
        {
            "company": "Splunk",
            "email": "davidd@splunk.com",
            "name": "David Dorsey"
        }
    ],
    "scheduling": {
        "cron_schedule": "0 * * * *",
        "earliest_time": "-70m@m",
        "latest_time": "-10m@m"
    },
    "search": "| tstats `summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `ctime(lastTime)` | `ctime(firstTime)`| rex field=file_name \"(?<file_extension>\\.[^\\.]+)$\" | `ransomware_extensions`",

    "search_description": "The search looks for file modifications with extensions commonly used by Ransomware",
    "search_id": "a9e5c5db-db11-43ca-86a8-c852d1b2c0ec",
    "search_name": "Common Ransomware Extensions",
    "search_type": "detection",
    "security_domain": "endpoint",
    "spec_version": 1,
    "version": "2.0"
}
